Based on coffeelings by cnmon https://github.com/cnnmon/coffeelings/tree/master